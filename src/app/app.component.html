<app-graphics-view 
  #graphicsView class="canvas" 
  [matrices]="matrices$ | async" 
  [selectedIndex]="selectedIndex"
  [hoveredTransformation]="hoveredTransformation" 
  [axesVisible]="axesVisible" />
<mat-button-toggle-group class="viewport-options" multiple vertical (change)="setAxesVisible($event)">
  <mat-button-toggle value="axes">AX</mat-button-toggle>
</mat-button-toggle-group>
<div [formGroup]="matrixForm">
  <div formArrayName="matrixArray" cdkDropList #doneList="cdkDropList" class="equation-list"
    cdkDropListOrientation="horizontal" cdkDropListLockAxis="x" (cdkDropListDropped)="drop($event)">
    @for (alias of matrixArray.controls; track alias; let i = $index) {
    @if ($first) {
      <div class="math" before>x' =</div>
      <app-add-transformations (addTransformation)="addTransformation($event,i)" (mouseover)="hoverTransformation(i)"
      (mouseout)="hoverTransformation(-1)" />      
    }
      <app-matrix [formControlName]="i"  [class.selected]="selectedIndex === i" (mouseover)="select(i)"
      (mouseout)="select(-1)">
      </app-matrix>
    <app-add-transformations (addTransformation)="addTransformation($event,i+1)" (mouseover)="hoverTransformation(i+1)"
      (mouseout)="hoverTransformation(-1)" />
      @if ($last) {
      <div class="math" after style="display: flex; flex-direction: row;">x
        <mat-button-toggle-group vertical (change)="graphicsView.setModel($event.value)">
          <mat-button-toggle value="smiley"><mat-icon>
            sentiment_satisfied
          </mat-icon></mat-button-toggle>
          <mat-button-toggle value="home"><mat-icon>
            home
          </mat-icon></mat-button-toggle>
        </mat-button-toggle-group>
      </div>

      }
    }
  </div>
</div>